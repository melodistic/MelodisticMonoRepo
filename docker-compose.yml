version: '3'
services:
  stream-frontend:
    restart: always
    image: melodisticmonorepo_stream-frontend
    build: 
      context: streaming-frontend
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
  stream-backend:
    restart: always
    image: melodisticmonorepo_stream-backend
    build:
      context: stream
      dockerfile: Dockerfile
    volumes:
      - ./combine-result:/app/combine-result
    ports:
      - "5050:5050"
  combiner-system:
    restart: always
    image: melodisticmonorepo_combiner-system
    build:
      context: combiner/server
      dockerfile: Dockerfile
    volumes:
      - ./extract-data:/app/extract-data
      - ./combine-result:/app/combine-result
    ports:
      - "5500:5500"
    deploy:
      resources:
        limits:
          memory: 10g
